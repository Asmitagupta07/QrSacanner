<!-- user_profile.html -->
<!DOCTYPE html>
<html>
<head>
    <title>User Profile</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            padding: 8px;
            text-align: center;
            color: green;
        }
        .profile-details, .registration-details {
            margin-bottom: 20px;
        }
        .profile-details img {
            max-width: 150px;
            height: auto;
            display: block;
        }
        .profile-details p, .registration-details p {
            margin: 5px 0;
        }
        .profile-details h2, .registration-details h2 {
            color: #555;
        }
        .form-section {
            margin-bottom: 20px;
        }
        .form-section h3 {
            margin-bottom: 10px;
            border-bottom: 1px solid #ccc;
        }
        .form-section p {
            margin: 5px 0;
        }
        .container {
            max-width: 1000px;
            margin: auto;
            background: #f0f0f0;
            padding: 10px 50px;
        }
        h3 {
            color: blue;
            font-weight: bolder;
            font-family: revert;
        }
        .form-section h3 {
            margin-bottom: 10px;
            border-bottom: 4px solid #9099;
        }
    </style>
</head>
<body>
    
<div class="container">
    <h1>Contingent Bill (N)</h1>
    <div class="form-section">
        <h3>1. UNIT DETAILS</h3>
        <p><strong>Unit ID:</strong> {{ user_registration.unit_id }}</p>
        <p><strong>Unit Name:</strong> {{ user_registration.unit_name }}</p>
        <p><strong>Unit Address:</strong> {{ user_registration.unit_address }}</p>
        <p><strong>Dak ID:</strong> {{ user_registration.dak_id }}</p>
    </div>

    <div class="form-section">
        <h3>2. BUDGET DETAILS</h3>
        <p><strong>Code Head:</strong> {{ user_registration.codehead }}</p>
        <p><strong>IFA/CFA:</strong> {{ user_registration.ifa_cfa }}</p>
        <p><strong>Amount Allotment:</strong> {{ user_registration.amount_allotment }}</p>
        <p><strong>Amount Expended:</strong> {{ user_registration.amount_expended }}</p>
        <p><strong>Balance Allotment:</strong> {{ user_registration.balance_allotment }}</p>
    </div>

    <div class="form-section">
        <h3>3. SANCTION / SUPPLY ORDER DETAILS</h3>
        <p><strong>Expenditure Account:</strong> {{ user_registration.expenditure_account }}</p>
        <p><strong>Incurred By:</strong> {{ user_registration.incurred_by }}</p>
        <p><strong>During Month:</strong> {{ user_registration.during_month }}</p>
        <p><strong>Authority:</strong> {{ user_registration.authority }}</p>
        <p><strong>Sanction No:</strong> {{ user_registration.sanction_no }}</p>
        <p><strong>Sanction Date:</strong> {{ user_registration.sanction_date }}</p>
        <p><strong>Sanction Amount:</strong> {{ user_registration.sanction_amount }}</p>
        <p><strong>Supply Order No:</strong> {{ user_registration.supply_order_no }}</p>
        <p><strong>Supply Order Date:</strong> {{ user_registration.supply_order_date }}</p>
        <p><strong>Supply Order Amount:</strong> {{ user_registration.supply_order_amount }}</p>
    </div>

    <div class="form-section">
        <h3>4. EXPENDITURE DETAILS</h3>
        <!-- Display expenditure details if they are saved in a format accessible through user_registration -->
        <!-- For dynamic rows, you might need to iterate through a list if stored separately -->
        <table>
            <thead>
                <tr>
                    <th>Sl. No.</th>
                    <th>Item Description</th>
                    <th>Qty</th>
                    <th>Qty Type</th>
                    <th>Tax Type</th>
                    <th>Base Amount</th>
                    <th>Tax Amount</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for expenditure in user_registration.expenditures.all %}
                    <tr>
                        <td>{{ expenditure.sl_no }}</td>
                        <td>{{ expenditure.item_description }}</td>
                        <td>{{ expenditure.qty }}</td>
                        <td>{{ expenditure.qty_type }}</td>
                        <td>{{ expenditure.tax_type }}</td>
                        <td>{{ expenditure.base_amount }}</td>
                        <td>{{ expenditure.tax_amount }}</td>
                        <td>{{ expenditure.amount }}</td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="8">No expenditure details available.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="form-section">
        <h3>5. PAYMENT TO (BENEFICIARY)</h3>
        <p><strong>Vendor Name:</strong> {{ user_registration.vendor_name }}</p>
        <p><strong>MSME/Non-MSME:</strong> {{ user_registration.msme_nonmsme }}</p>
        <p><strong>Vendor Bank Account:</strong> {{ user_registration.vendor_bank_account }}</p>
        <p><strong>IFSC:</strong> {{ user_registration.ifsc }}</p>
        <p><strong>GSTIN:</strong> {{ user_registration.gstin }}</p>
        <p><strong>PAN:</strong> {{ user_registration.pan }}</p>
    </div>

    <div class="form-section">
        <h3>6. PAYING AUTHORITY</h3>
        <p><strong>Paying Authority:</strong> {{ user_registration.paying_authority }}</p>
    </div>

    <div class="form-section">
        <h3>Signature and Certification</h3>
        <p><strong>Signature:</strong> {{ user_registration.signature }}</p>
        <p><strong>Countersigned:</strong> {{ user_registration.countersigned }}</p>
        <p><strong>Received Payment:</strong> {{ user_registration.received_payment }}</p>
    </div>
</div>
</body>
</html>
 


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contingent Bill (N) Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .form-section {
            margin-bottom: 20px;
        }
        .form-section h3 {
            margin-bottom: 10px;
            border-bottom: 1px solid #ccc;
        }
        .form-section label {
            display: block;
            margin-bottom: 5px;
        }
        .form-section input, .form-section select, .form-section textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        .form-section table {
            width: 100%;
            border-collapse: collapse;
        }

        .form-section table, .form-section th, .form-section td {
            border: 1px solid #ccc;
        }

        .form-section .table1 {
            border: none; 
        }
        
        .form-section .table1 th, 
        .form-section .table1 td {
            border: none;
        }
        .form-section th, .form-section td {
            padding: 8px;
            text-align: left;
        }
        h1 {
            padding: 8px;
            text-align: center;
            color: green;
        }
        h3{
            color: blue ;
        }

        .container {
            max-width: 1000px;
            margin: auto;
            background: #f0f0f0;
            padding: 10px 50px;
        }
        .green-button {
            background-color: green;
            color: white;
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }
        
        .border-button {orm-section
            border: 2px solid green;
            border-radius: 5px;
            cursor: pointer;

        }
        .blue-button {
            background-color: blue;
            color: white;
            display: block;
            margin: 10px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }
    </style>
</head>
<body>
  <div class="container">
    <form method="post" >
        <h1>Contingent Bill (N)</h1>
        {% csrf_token %}
       
        <div class="form-section">
            <h3>1. UNIT DETAILS</h3>
            {{ form.unit_id.label_tag }}{{ form.unit_id }}
            {{ form.unit_name.label_tag }}{{ form.unit_name }}
            {{ form.unit_address.label_tag }}{{ form.unit_address }}
            {{ form.dak_id.label_tag }}{{ form.dak_id }}
        </div>

        <div class="form-section">
            <h3>2. BUDGET DETAILS</h3>
            {{ form.codehead.label_tag }}{{ form.codehead }}
            {{ form.ifa_cfa.label_tag }}{{ form.ifa_cfa }}
            {{ form.amount_allotment.label_tag }}{{ form.amount_allotment }}
            {{ form.amount_expended.label_tag }}{{ form.amount_expended }}
            {{ form.balance_allotment.label_tag }}{{ form.balance_allotment }}
        </div>

        <div class="form-section">
            <h3>3. SANCTION / SUPPLY ORDER DETAILS</h3>
            {{ form.expenditure_account.label_tag }}{{ form.expenditure_account }}
            {{ form.incurred_by.label_tag }}{{ form.incurred_by }}
            {{ form.during_month.label_tag }}{{ form.during_month }}
            {{ form.authority.label_tag }}{{ form.authority }}
            {{ form.sanction_no.label_tag }}{{ form.sanction_no }}
            {{ form.sanction_date.label_tag }}{{ form.sanction_date }}
            {{ form.sanction_amount.label_tag }}{{ form.sanction_amount }}
            {{ form.supply_order_no.label_tag }}{{ form.supply_order_no }}
            {{ form.supply_order_date.label_tag }}{{ form.supply_order_date }}
            {{ form.supply_order_amount.label_tag }}{{ form.supply_order_amount }}
        </div>

        <div class="form-section">
            <h3>4. EXPENDITURE DETAILS</h3>
            <table>
                <thead>
                    <tr>
                        <th>Sl. No.</th>
                        <th>Item Description</th>
                        <th>Qty</th>
                        <th>Qty Type</th>
                        <th>Tax Type</th>
                        <th>Base Amount</th>
                        <th>Tax Amount</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody id="expenditure-rows">
                    <!-- Populate initial rows here if needed -->
                </tbody>
            </table>
            <button type="button" class="border-button" onclick="addExpenditureRow()">Add Row</button>
        </div>

        <div class="form-section">
            {{ form.bill_no.label_tag }}{{ form.bill_no }}
            {{ form.bill_date.label_tag }}{{ form.bill_date }}
            {{ form.invoice_no.label_tag }}{{ form.invoice_no }}
            {{ form.invoice_date.label_tag }}{{ form.invoice_date }}
            {{ form.disallowed_amount.label_tag }}{{ form.disallowed_amount }}
            {{ form.total_bill_amount.label_tag }}{{ form.total_bill_amount }}
            {{ form.crv_esic_epfo_no.label_tag }}{{ form.crv_esic_epfo_no }}
            {{ form.crv_esic_epfo_date.label_tag }}{{ form.crv_esic_epfo_date }}
        </div>

        <div class="form-section">
            <h3>5. PAYMENT TO (BENEFICIARY)</h3>
            {{ form.vendor_name.label_tag }}{{ form.vendor_name }}
            {{ form.msme_nonmsme.label_tag }}{{ form.msme_nonmsme }}
            {{ form.vendor_bank_account.label_tag }}{{ form.vendor_bank_account }}
            {{ form.ifsc.label_tag }}{{ form.ifsc }}
            {{ form.gstin.label_tag }}{{ form.gstin }}
            {{ form.pan.label_tag }}{{ form.pan }}
        </div>

        <div class="form-section">
            <h3>6. PAYING AUTHORITY</h3>
            {{ form.paying_authority.label_tag }}{{ form.paying_authority }}
        </div>

        <div class="form-section">
            <p>
                Certified that the above charges have been necessarily incurred in the interest of the State that the rates charged are the lowest obtainable and that all receipts for sums of Rs……… and under except as regards payments made in the MES to Contractors on running accounts have been so destroyed defaced or mutilated that they cannot be used again and that I have personally checked the progressive total in the bill with that in the contingent registers and found it to agree.
            </p>

            <table class="table1">
                <tr>
                  <th>Signature</th>
                  <th>Countersigned</th>
                  <th>Received Payment</th>    
                </tr>
                <tr>
                  <td>__________________________</td>
                  <td>__________________________</td>    
                  <td>__________________________</td>  
                </tr>
              </table>
        </div>

        <button type="submit" class="green-button">Submit</button>
        
    </form>
    {% comment %} {% if user_profile %}
    <h2>Your QR Code</h2>
    <img id="qrCodeImg" src="{{ user_profile.qr_code.url }}" alt="QR Code">
    <a id="downloadQr" download="qrcode.png">
        <button class="blue-button">Download QR Code</button>
    </a>
    {% endif %} {% endcomment %}

  </div>
    <script>
        function addExpenditureRow() {
            const table = document.getElementById('expenditure-rows');
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td><input type="number" name="sl-no"></td>
                <td><input type="text" name="item-description"></td>
                <td><input type="number" name="qty"></td>
                <td><input type="text" name="qty-type"></td>
                <td><input type="text" name="tax-type"></td>
                <td><input type="number" name="base-amount"></td>
                <td><input type="number" name="tax-amount"></td>
                <td><input type="number" name="amount"></td>
            `;
            
            table.appendChild(row);
        }

        {% comment %} document.addEventListener("DOMContentLoaded", function() {
            const qrCodeImg = document.getElementById('qrCodeImg');
            const downloadQr = document.getElementById('downloadQr');

            if (qrCodeImg && downloadQr) {
                downloadQr.href = qrCodeImg.src;
            }
        }); {% endcomment %}
    </script>
    {% if error_message %}
    <script>
        alert("{{ error_message }}");
    </script>
    {% endif %}
    

</body>
</html>
