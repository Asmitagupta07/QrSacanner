<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contingent Bill (N) Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .form-section {
            margin-bottom: 20px;
        }
        .form-section h3 {
            margin-bottom: 10px;
            border-bottom: 1px solid #ccc;
        }
        .form-section label {
            display: block;
            margin-bottom: 5px;
        }
        .form-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .form-table td {
            padding: 8px;
            vertical-align: top;
        }
        .form-table input, .form-table select, .form-table textarea {
            width: 95%;
            padding: 8px;
            box-sizing: border-box;
        }
        .form-section input, .form-section select, .form-section textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        h1 {
            padding: 8px;
            text-align: center;
            color: green;
        }
        h3 {
            color: blue;
        }
        .container {
            max-width: 1000px;
            margin: auto;
            background: #f0f0f0;
            padding: 10px 50px;
        }
        .green-button {
            background-color: green;
            color: white;
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }
        .form-section table {
            width: 100%;
            border-collapse: collapse;
        }
        .form-section .table1 {
            border: none; 
        }
        
        .form-section .table1 th, 
        .form-section .table1 td {
            border: none;
        }
        .blue-button {
            background-color: blue;
            color: white;
            margin: 10px;
            /* padding: 10px 20px; */
            /* border: none; */
            /* border: none; */
            /* display: block; */
            cursor: pointer;
            text-align: center;
            width: 83px;
        }
        .border-button {orm-section
            border: 2px solid green;
            border-radius: 5px;
            cursor: pointer;

        }
        .contingent-table #qrCodeImg {
            width: 200px;
            height: 200px;
            object-fit: contain;
            margin-left: auto;
        }
        textarea#id_unit_address {
            height: 100px;
        }
        th, td {
            {% comment %} border: 1px solid #000; {% endcomment %}
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button.grey {
            background-color: crimson;
            color: white;
            width: 86px;
        }
    </style>
</head>
<body>
  <div class="container">
    <form method="post">
        <h1>Contingent Bill (N)</h1>
        {% if error_message %}
        <div class="error-message" style="color: red; font-weight: bold;">
            <p>{{ error_message }}</p>
        </div>
        {% endif %}
        
        {% if form.errors %}
            <div class="field-errors" style="color: red;">
                {% for field in form %}
                    {% if field.errors %}
                        <div>
                            <strong>{{ field.label }}:</strong>
                            <ul>
                                {% for error in field.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        {% endif %}

        {% csrf_token %}

        <!-- Unit Details Section -->
        <div class="form-section">
       
            <h3>1. UNIT DETAILS</h3>
            <table class="form-table">
                <tr>
                    <th>{{ form.unit_id.label_tag }}</th>
                    <td>{{ form.unit_id }}</td>
                    <th>{{ form.unit_name.label_tag }}</th>
                    <td>{{ form.unit_name }}</td>
                </tr>
                <tr>
                    <th>{{ form.unit_address.label_tag }}</th>
                    <td>{{ form.unit_address }}</td>
                    <th>{{ form.dak_id.label_tag }}</th>
                    <td>{{ form.dak_id }}</td>
                </tr>
            </table>
        </div>

        <!-- Budget Details Section -->
        <div class="form-section">
            <h3>2. BUDGET DETAILS</h3>
            <table class="form-table">
                <tr>
                    <th>{{ form.codehead.label_tag }}</th>
                    <td>{{ form.codehead }}</td>
                    <th>{{ form.ifa_cfa.label_tag }}</th>
                    <td>{{ form.ifa_cfa }}</td>
                </tr>
                <tr>
                    <th>{{ form.amount_allotment.label_tag }}</th>
                    <td>{{ form.amount_allotment }}</td>
                    <th>{{ form.amount_expended.label_tag }}</th>
                    <td>{{ form.amount_expended }}</td>
                </tr>
                <tr>
                    <th>{{ form.balance_allotment.label_tag }}</th>
                    <td>{{ form.balance_allotment }}</td>
                </tr>
            </table>
        </div>

        <!-- Sanction/Supply Order Details Section -->
        <div class="form-section">
            <h3>3. SANCTION / SUPPLY ORDER DETAILS</h3>
            <table class="form-table">
                <tr>
                    <th>{{ form.expenditure_account.label_tag }}</th>
                    <td>{{ form.expenditure_account }}</td>
                    <th>{{ form.incurred_by.label_tag }}</th>
                    <td>{{ form.incurred_by }}</td>
                </tr>
                <tr>
                    <th>{{ form.during_month.label_tag }}</th>
                    <td>{{ form.during_month }}</td>
                    <th>{{ form.authority.label_tag }}</th>
                    <td>{{ form.authority }}</td>
                </tr>
                <tr>
                    <th>{{ form.sanction_no.label_tag }}</th>
                    <td>{{ form.sanction_no }}</td>
                    <th>{{ form.sanction_date.label_tag }}</th>
                    <td>{{ form.sanction_date }}</td>
                </tr>
                <tr>
                    <th>{{ form.supply_order_no.label_tag }}</th>
                    <td>{{ form.supply_order_no }}</td>
                    <th>{{ form.supply_order_date.label_tag }}</th>
                    <td>{{ form.supply_order_date }}</td>
                </tr>
                <tr>
                    <th>{{ form.sanction_amount.label_tag }}</th>
                    <td>{{ form.sanction_amount }}</td>
                    <th>{{ form.supply_order_amount.label_tag }}</th>
                    <td>{{ form.supply_order_amount }}</td>
                </tr>
            </table>
        </div>

        <!-- Expenditure Details Section -->
        <div class="form-section">
            <h3>4. EXPENDITURE DETAILS</h3>
            <table class="form-table">
                <thead>
                    <tr>
                        <th>Sl. No.</th>
                        <th>Item Description</th>
                        <th>Qty</th>
                        <th>Qty Type</th>
                        <th>Tax Type</th>
                        <th>Base Amount</th>
                        <th>Tax Amount</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody id="expenditure-rows">
                    {% for row in form.expenditure %}
                        <tr>
                            <td><input type="number" name="sl_no" value="{{ row.sl_no }}" readonly></td>
                            <td><input type="text" name="item_description" value="{{ row.item_description }}"></td>
                            <td><input type="number" name="qty" value="{{ row.qty }}"></td>
                            <td><input type="text" name="qty_type" value="{{ row.qty_type }}"></td>
                            <td><input type="text" name="tax_type" value="{{ row.tax_type }}"></td>
                            <td><input type="number" name="base_amount" value="{{ row.base_amount }}"></td>
                            <td><input type="number" name="tax_amount" value="{{ row.tax_amount }}"></td>
                            <td><input type="number" name="amount" value="{{ row.amount }}"></td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>

            <button type="button" class="blue-button" onclick="addExpenditureRow()">Add Row</button>
            <button type="button" class="grey" onclick="deleteExpenditureRow()">Delete Row</button>
            <table class="form-table">
                <tr>
                    <th>{{ form.bill_no.label_tag }}</th>
                    <td>{{ form.bill_no }}</td>
                    <th>{{ form.bill_date.label_tag }}</th>
                    <td>{{ form.bill_date }}</td>
                </tr>
                <tr>
                    <th>{{ form.invoice_no.label_tag }}</th>
                    <td>{{ form.invoice_no }}</td>
                    <th>{{ form.invoice_date.label_tag }}</th>
                    <td>{{ form.invoice_date }}</td>
                </tr>
                <tr>
                    <th>{{ form.disallowed_amount.label_tag }}</th>
                    <td>{{ form.disallowed_amount }}</td>
                    <th>{{ form.total_bill_amount.label_tag }}</th>
                    <td>{{ form.total_bill_amount}}</td>
                </tr>
                <tr>
                    <th>{{ form.crv_esic_epfo_no.label_tag  }}</th>
                    <td>{{ form.crv_esic_epfo_no }}</td>
                    <th>{{ form.crv_esic_epfo_date.label_tag }}</th>
                    <td>{{ form.crv_esic_epfo_date }}</td>
                </tr>
            </table>
        </div>

        <!-- Payment to Beneficiary Section -->
        <div class="form-section">
            <h3>5. PAYMENT TO (BENEFICIARY)</h3>
            <table class="form-table payment-table">
                <tr>
                    <th>{{ form.vendor_name.label_tag }}</th>
                    <td colspan="3">{{ form.vendor_name }}</td>
                    
                </tr>
                <tr>
                    <th>{{ form.msme_nonmsme.label_tag }}</th>
                    <td>{{ form.msme_nonmsme }}</td>
                    <th>{{ form.Make.label_tag }}</th>
                    <td>{{ form.Make }}</td>
                </tr>
                <tr>
                    <th>{{ form.vendor_bank_account.label_tag }}</th>
                    <td>{{ form.vendor_bank_account }}</td>
                    <th>{{ form.ifsc.label_tag }}</th>
                    <td>{{ form.ifsc }}</td>
                </tr>
                <tr>
                    <th>{{ form.gstin.label_tag }}</th>
                    <td>{{ form.gstin }}</td>
                    <th>{{ form.pan.label_tag }}</th>
                    <td>{{ form.pan }}</td>
                   
                </tr>
              
            </table>
        </div>
        

        <!-- PAYING AUTHORITY -->
        <div class="form-section">
            <h3>6. PAYING AUTHORITY</h3>
            <th>{{ form.paying_authority.label_tag}}</th>
            <td>{{ form.paying_authority }}</td>
        </div>

        <div class="form-section">
            <p>
                Certified that the above charges have been necessarily incurred in the interest of the State that the rates charged are the lowest obtainable and that all receipts for sums of Rs……… and under except as regards payments made in the MES to Contractors on running accounts have been so destroyed defaced or mutilated that they cannot be used again and that I have personally checked the progressive total in the bill with that in the contingent registers and found it to agree.
            </p>

            <table class="table1">
                <tr>
                  <th>Signature</th>
                  <th>Countersigned</th>
                  <th>Received Payment</th>    
                </tr>
                <tr>
                  <th>__________________________</th>
                  <th>__________________________</th>    
                  <th>__________________________</th>  
                </tr>
              </table>
        </div>


        <button type="submit" class="green-button">Submit</button>

    </form>
  </div>

  <script>
    function addExpenditureRow() {
        const table = document.getElementById('expenditure-rows');
        const row = document.createElement('tr');
        const nextSlNo = table.rows.length + 1;
        row.innerHTML = `
            <td><input type="number" name="sl_no" value="${nextSlNo}" readonly></td>
            <td><input type="text" name="item_description"></td>
            <td><input type="number" name="qty"></td>
            <td><input type="text" name="qty_type"></td>
            <td><input type="text" name="tax_type"></td>
            <td><input type="number" name="base_amount"></td>
            <td><input type="number" name="tax_amount"></td>
            <td><input type="number" name="amount"></td>
        `;
        table.appendChild(row);
    }
    
    function deleteExpenditureRow() {
        const tableBody = document.getElementById('expenditure-rows');
        if (tableBody.rows.length > 0) {
            tableBody.deleteRow(tableBody.rows.length - 1); // Delete the last row
        } else {
            alert('No rows to delete!');
        }
    }
    
  </script>
</body>
</html>
